!function(e){"use strict";e(".js-rey-copy-code").on("click",(function(t){t.preventDefault();var i=e(t.currentTarget),n=(e(i).text(),e(i).next("pre").text()),r=e("<input>");e("body").append(r),r.val(n).select(),document.execCommand("copy"),r.remove(),i.closest(".rey-codeBlock").addClass("is-copied")})),!_.isUndefined(reyCoreAdmin.back_btn_text)&&_.isUndefined(reyCoreAdmin.back_btn_url)&&e(".post-type-rey-global-sections.post-php a.page-title-action").after((function(){return'<a class="rey-gs-back-button" href="'+reyCoreAdmin.back_btn_url+'">'+reyCoreAdmin.back_btn_text+"</a>"}));var t,i,n=!1;window.onbeforeunload=function(){if(n)return"Import is in progress!"},e(".js-rey-refresh-demos").on("click",(function(t){t.preventDefault();var i=e(this);i.addClass("--loading").text(reyCoreAdmin.strings.refreshing_btn_text),e.ajax({url:reyCoreAdmin.ajax_url,cache:!1,data:{action:"rey_refresh_demos",security:reyCoreAdmin.ajax_nonce},success:function(e){e&&1==e.success&&(i.text(reyCoreAdmin.strings.reloading),setTimeout((function(){location.reload()}),1e3))},error:function(e,t,n){i.removeClass("--loading").text(reyCoreAdmin.strings.refresh_demos_error),console.error(e),console.error(t),console.error(n)}})})),e(document).on("ocdiImportComplete",(function(){var t=new Audio(reyCoreAdmin.sound_effect);t.oncanplay=function(){t.play()},e(".js-ocdi-ajax-response").length&&e("html, body").animate({scrollTop:e(".js-ocdi-ajax-response").offset.top})})),rey.frontend.inView({target:".__admin-lazy-img",once:!0,cb:function(e){e.target.setAttribute("src",e.target.getAttribute("data-src")),e.target.classList.add("--loaded")}}),e(document).on("ocdiImportComplete",(function(t){var i=e(".js-ocdi-ajax-response");i.append('<div class="notice notice-success"><p>'+reyCoreAdmin.ocdi_strings.visit_site+"</p></div>"),n=!1,e("body").removeClass("rey-is-importing"),document.title=reyCoreAdmin.ocdi_strings.title_done,e(".notice.notice-warning p",i).each((function(t,n){-1!=n.textContent.toLowerCase().indexOf("error: widget import")&&(n.remove(t),e(".notice.notice-warning:empty",i).remove())}))})),e(document).on("reycore/ocdi/failed_import ",(function(t){e(".js-ocdi-ajax-response").append('<div class="notice notice-error is-dismissible"><p>'+reyCoreAdmin.ocdi_strings.seek_help+"</p></div>"),n=!1,e("body").removeClass("rey-is-importing"),document.title=reyCoreAdmin.ocdi_strings.title_done})),e(document).on("reycore/ocdi/import_demo",(function(t,i,r,a,s,o){n=!0,document.title=reyCoreAdmin.ocdi_strings.title_importing;var c=function(){a.dialog("close"),e.ocdiGridLayoutImport(i,r),e("body").addClass("rey-is-importing")},d=reyAdminParams&&reyAdminParams.tgmpa&&2==reyAdminParams.tgmpa,l=[],u=new URL(window.location.href).searchParams.get("page")||"",p=e("#js-plugin-dep--"+o[i].slug).find('input[type="checkbox"]');if(p.length){p.each((function(t,i){e(i).prop("checked")&&l.push(e(i).val()),e(i).prop("disabled",!0)})),s.addClass("disabled"),s.prev(".ui-button").addClass("disabled"),a.closest(".wp-dialog--rey").find(".ui-dialog-titlebar-close").hide(300),a.dialog("option","closeOnEscape",!1),e(".rey-pluginDeps input:checked",a).closest("li").addClass("--is-installing"),a.append("<p class='reyAdmin-response reyAdmin-notice --info'>"+reyCoreAdmin.ocdi_strings.installing_plugins_text+"</p>");var g=!0,f=function(){var t={method:"post",url:reyCoreAdmin.ajax_url,dataType:"text",cache:!1,data:{action:"rey_install_plugin_dependencies",security:reyCoreAdmin.ajax_nonce,plugins:l,page:u},success:function(t){var i=function(e){if(d)return e;var t=/{("success"[^}]+)}/g.exec(e);return!(!t||!t.length)&&JSON.parse(t[0])}(t);i?(i.success&&!0===i.success&&!1!==i.data?(e(".rey-pluginDeps li[data-slug='"+i.data+"']",a).hide(400),f()):(e(".reyAdmin-response",a).text(reyCoreAdmin.ocdi_strings.finished_installing_plugins),setTimeout((function(){c()}),1e3)),g=!1):(s.removeClass("loading"),e(".reyAdmin-response",a).remove(),a.append("<p class='reyAdmin-response reyAdmin-notice --error'>"+i.data+"</p>"))},error:function(t,i,n){e(".reyAdmin-response",a).remove(),a.append("<p class='reyAdmin-response reyAdmin-notice --error'>"+reyCoreAdmin.ocdi_strings.something_went_wrong+"</p>")}};g&&(t.data.first=!0),d&&(t.dataType="json"),e.ajax(t)};f()}else c()})),t=e("#tmpl-customize-control-kirki-toggle-content"),i=(i=t.text()).replace("screen-reader-text","screen-reader-text-reyToggle"),t.text(i);var r,a=function(t){var i=this;this.init=function(){t&&(this.config=e.extend({scope:"","condition-attribute":"data-condition"},t),this.config.scope&&e(this.config.scope).length&&(this.checkConds(),e("input, select",this.config.scope).on("change",(function(e){i.checkConds()}))))},this.checkConds=function(){var t=this;e("["+this.config["condition-attribute"]+"]",this.config.scope).each((function(i,n){var r=e(n),a=JSON.parse(r.attr(t.config["condition-attribute"])||"{}"),s=[];if(!e.isEmptyObject(a)){e.each(a,(function(i,n){var r=e('[name="'+n.name+'"]',t.config.scope),a=r.val();r.is('[type="checkbox"]')&&(a=r.prop("checked")),s.push(t.evaluateCondition(n.value,a,n.compare))}));var o=s.every((function(e){return!0===e}));r.toggleClass("hidden",!o)}}))},this.evaluateCondition=function(e,t,i){if("==="===i)return e===t;if("=="===i||"="===i||"equals"===i||"equal"===i)return e==t;if("!=="===i)return e!==t;if("!="===i||"not equal"===i)return e!=t;if(">="===i||"greater or equal"===i||"equal or greater"===i)return t>=e;if("<="===i||"smaller or equal"===i||"equal or smaller"===i)return t<=e;if(">"===i||"greater"===i)return t>e;if("<"===i||"smaller"===i)return t<e;if("contains"===i||"in"===i){if(_.isArray(e)&&_.isArray(t))return _.each(t,(function(t){if(e.includes(t))return found=!0,!1})),found;if(_.isArray(t))return _.each(t,(function(t){t==e&&(found=!0)})),found;if(_.isObject(t))return _.isUndefined(t[e])||(found=!0),_.each(t,(function(t){e===t&&(found=!0)})),found;if(_.isString(t))return _.isString(e)?-1<e.indexOf(t)&&-1<t.indexOf(e):-1<e.indexOf(t)}return"!contains"===i||"does not contain"===i||"not in"===i?!this.evaluateCondition(e,t,"contains"):e==t},this.init()},s=function(){e("[data-rey-controls]").each((function(){var t=e(this),i=JSON.parse(t.attr("data-rey-controls")||"{}");if(!e.isEmptyObject(i)){var n=!1;if(i["form-scope"]){var r=e(i["form-scope"]);r.length&&(n=r.is("form")?r:r.closest("form"))}else t.is("form")&&(n=t);n&&new a({scope:n,"condition-attribute":i["condition-attribute"]})}}))},o=function(t){this.init=function(){this.scope=t||e("#widgets-right .widget-content"),this.dependencies(),this.priceFilterWidget(),this.repeaterField(),this.makeTabs(),this.makeTitle()},this.dependencies=function(){this.scope.each((function(){new a({scope:this})}))},this.makeTabs=function(){e(".rey-widgetTabs-wrapper",this.scope).each((function(t,i){var n=e(i),r=e(".rey-widgetTabs-buttons span",n),a=e(".rey-widgetTabs-tabContent",n);r.on("click",(function(t){t.preventDefault();var i=e(this).attr("data-tab");r.removeClass("--active"),a.removeClass("--active"),e(this).addClass("--active"),e('.rey-widgetTabs-tabContent[data-tab="'+i+'"]',n).addClass("--active")}))}))},this.makeTitle=function(){e(".rey-widgetToTitle",this.scope).each((function(t,i){var n=e(i),r=e(i).closest(".widget").find(".widget-title h3");e("<span/>").addClass(n.attr("data-class")||"").html(n.html()).appendTo(r)}))},this.repeaterField=function(){e(".rey-widgetRepeater-add",this.scope).on("click",(function(t){var i=e(this).closest(".rey-widgetRepeater-wrapper"),n=e(".rey-widgetRepeater-listWrapper",i),r=wp.template("rey-"+n.attr("data-id"))({int:parseInt(e(".rey-widgetRepeater-list.--default",n).last().attr("data-key")||10)+1});n.append(r)})),e(document).on("click",".rey-widgetRepeater-remove",(function(t){var i=e(this);i.closest(".rey-widgetRepeater-listWrapper");i.parent().hide().remove()}))},this.priceFilterWidget=function(){var t=this;e(".rey-widgetRangePoints-add",this.scope).on("click",(function(t){var i=e(this).closest(".rey-widgetRangePoints-wrapper"),n=e(".rey-widgetRangePoints-listWrapper",i),r=wp.template("rey-"+n.attr("data-id"))({int:parseInt(e(".rey-widgetRangePoints-list.--default",n).last().attr("data-key")||10)+1});n.append(r)})),e(document).on("click",".rey-widgetRangePoints-remove",(function(t){var i=e(this);i.closest(".rey-widgetRangePoints-listWrapper");i.parent().hasClass("--start")||i.parent().hasClass("--end")||i.parent().hide().remove()})),e.each(["start","end"],(function(i,n){e(".rey-widgetRangePoints-add-"+n,t.scope).on("click",(function(t){t.preventDefault();var i=e(this).closest(".rey-widgetRangePoints-wrapper"),r=e(".rey-widgetRangePoints-list.--"+n,i);r.removeClass("--hidden"),e('input[type="hidden"]',r).val("1"),e(this).addClass("--inactive")})),e(document).on("click",".rey-widgetRangePoints-list.--"+n+" .rey-widgetRangePoints-remove",(function(i){i.preventDefault();var r=e(this);r.parent().addClass("--hidden"),e('input[type="hidden"]',r.parent()).val(""),e(".rey-widgetRangePoints-add-"+n,t.scope).removeClass("--inactive")}))}))},this.init()},c=function(){var t="#widgets-only-visible-terms--",i=[],n=e(".wp-admin.widgets-php #widgets-right"),r=e('a[href^="'+t+'"]',n);r.each((function(a,s){var o=e(s).attr("href").split("--");i.push(o[1]),r.length-1===a&&e.post({url:reyCoreAdmin.ajax_url,data:{term_ids:i,action:"rey_custom_sidebars_links",security:reyCoreAdmin.ajax_nonce},success:function(i){"object"!=typeof i||i.error||e.each(i,(function(i,r){var a=e('a[href^="'+t+i+'"]',n);a.length&&a.attr({href:r,target:"_blank"})}))}})}))};e(document).on("widget-added widget-updated",(function(e,t){new o(t)})),e(document).ready((function(){new o,new c,new s})),void 0!==(r=wp.customize)&&r.bind("ready",(function(){r.section.each((function(e){"widgets"===e.params.panel&&e.expanded.bind((function(e){e&&new o}))}))})),e(".js-toggle-ocdi-settings").on("change",(function(t){var i=e(t.target),n=i.closest(".rey-toggleSwitch"),r=i.attr("data-setting");n.addClass("--disabled"),e.ajax({method:"post",url:reyCoreAdmin.ajax_url,data:{action:"change_ocdi_setting",security:reyCoreAdmin.ajax_nonce,status:i.prop("checked"),setting:r},success:function(e){e&&e.data&&i.prop("checked",e.data),n.removeClass("--disabled")},error:function(e,t,i){console.error(e),console.error(t),console.error(i)}})})),e(".js-rey-demos-adjust-settings").on("click",(function(t){t.preventDefault(),e(this).parent().find(".rey-demosImportSettings").toggleClass("--hidden")})),e(".reyAdm-notice").each((function(){var t=e(this),i=t.attr("data-key");if(i){var n="reycore-dismissed-"+i;rey.util.ls.get(n)&&!0===rey.util.ls.get(n)||t.addClass("--visible"),e(".reyAdm-noticeDismiss[data-dismiss]",t).on("click",(function(i){i.preventDefault();var r=e(this),a=r.attr("data-dismiss");"1day"===a?(t.removeClass("--visible"),rey.util.ls.set(n,!0,864e5)):"always"===a&&(t.css({opacity:".8","pointer-events":"none"}),e.ajax({url:reyCoreAdmin.ajax_url,cache:!1,data:{action:r.attr("data-action"),security:reyCoreAdmin.ajax_nonce},success:function(e){e&&1==e.success?t.removeClass("--visible"):t.css({opacity:"","pointer-events":""})},error:function(e,i,n){t.css({opacity:"","pointer-events":""})}}))}))}})),e(document).on("click",".rey-whatsNew .__never-show",(function(t){t.preventDefault();var i=e(this);i.addClass("--loading disabled"),rey.ajax.request("whatsnew_page_visibility",{cb:function(e){e&&e.success&&(!e.data||e.data&&e.data.error?i.text("Error! Check console."):(i.text("Done! Redirecting to dashboard.."),setTimeout((function(){window.location.href=reyAdminParams.dashboard_url}),2e3)))}})})),e(document).on("click",".rey-whatsNew .__hide-until-next",(function(t){t.preventDefault();var i=e(this);i.addClass("--loading disabled"),rey.ajax.request("whatsnew_hide_until_next_major",{cb:function(e){e&&e.success&&(!e.data||e.data&&e.data.error?i.text("Error! Check console."):(i.text("Done! Redirecting to dashboard.."),setTimeout((function(){window.location.href=reyAdminParams.dashboard_url}),2e3)))}})})),e(".js-ig-refresh-token").on("click",(function(t){t.preventDefault();var i=e(this);i.addClass("--loading").text(reyCoreAdmin.strings.refreshing_btn_text),e.ajax({url:reyCoreAdmin.ajax_url,cache:!1,data:{action:"rey_refresh_ig_token",security:reyCoreAdmin.ajax_nonce},success:function(e){e&&1==e.success&&(i.text(reyCoreAdmin.strings.reloading),setTimeout((function(){location.reload()}),1e3))}})})),e(".js-ig-migrate-token").on("click",(function(t){t.preventDefault();var i=e(this);i.addClass("--loading").text(reyCoreAdmin.strings.migrating_btn_text),e.ajax({url:reyCoreAdmin.ajax_url,cache:!1,data:{action:"rey_migrate_ig_token",security:reyCoreAdmin.ajax_nonce},success:function(e){e&&e.success&&(i.text(reyCoreAdmin.strings.reloading),setTimeout((function(){location.reload()}),1e3))}})}));var d=function(){localStorage.setItem("reycore/infinite_cleanup",!0)};e(".wp-admin #post").on("submit",d),wp&&wp.customize&&wp.customize.bind("save",d);var l;l={},e(document).on("mouseenter",".rey-previewIframe",(function(e){var t=e.currentTarget,i=t.getAttribute("data-id");if(!t.getAttribute("data-loaded")){var n=t.querySelector("iframe");n&&(l[i]=setTimeout((function(){var e=n.getAttribute("data-src");n.setAttribute("src",e),n.addEventListener("load",(function(){t.classList.add("--loaded"),t.setAttribute("data-loaded","")}))}),300))}})).on("mouseleave",".rey-previewIframe",(function(e){var t=e.currentTarget,i=t.getAttribute("data-id");t.getAttribute("data-loaded")||clearTimeout(l[i])}));new function(){this.init=function(){this.wrapper=document.getElementById("migrations-scripts"),this.wrapper&&(this.select=this.wrapper.querySelector("select"),this.button=this.wrapper.querySelector(".rey-adminBtn"),this.responseWrapper=this.wrapper.querySelector(".__response"),this.events())},this.events=function(){this.select.addEventListener("change",(e=>{this.button.classList.toggle("--disabled",!e.target.value)})),this.button.addEventListener("click",(e=>{if(e.preventDefault(),this.select.value){var t=this.select.querySelector(`option[value="${this.select.value}"]`).textContent||this.select.value;confirm(`Are you sure you want to run the "${t}" script?`)&&(this.button.classList.add("--disabled","--loading"),rey.ajax.request("migrations",{data:{script:this.select.value},params:{cache:!1},cb:e=>{e.data.error?console.log(e.data.error):(this.button.classList.remove("--loading"),this.button.textContent=e.data)}}))}}))},this.init()},e('#toplevel_page_rey-dashboard a[href*="customize.php"]').attr("target","_blank")}(jQuery);