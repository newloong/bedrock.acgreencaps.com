!function(e){"use strict";var t=function(){var t=this;this.init=function(){this.$productPage=e("div.product"),this.productPage=document.querySelector("div.product"),this.general(),this.reviewsBtn(),this.handleQtyInputMinStep(),this.reviewsForm(),this.addedToCartText(),this.fsSkinErrors(),this.runLazyReviews(),this.runLazyRelated(),this.runLazyUpsells(),this.events()},this.events=function(){e(document).on("focus",".rey-cartBtnQty input.--select-text",(function(e){e.currentTarget.select()})),rey.hooks.addAction("first_interaction",(function(){setTimeout((function(){t.customTextNearPrice()}),2e3)}));var r={};e(document.body).on("found_variation reset_data",".variations_form",((t,a)=>{var o=t.currentTarget.closest("div.product");if(o){o.classList.toggle("--found-variation","object"==typeof a),this.handleSkuVisibility(a);var i=e(".rey-estimatedDelivery",o);if(i.length){var n=o.getAttribute("id");r[n]||(r[n]=i.html()),a&&a.estimated_delivery?i.html(a.estimated_delivery):i.html(r[n])}}}))},this.handleSkuVisibility=function(e){this.productPage.querySelectorAll(".sku_wrapper .sku").forEach((t=>{var r=t.parentElement;"object"==typeof e?e.sku?r.style.display="":r.style.display="none":r.getAttribute("data-o-sku")?r.style.display="":r.style.display="none"}))},this.reviewsBtn=function(){var e=document.querySelector(".js-reviewsBtn");if(e){var t=document.querySelector(".rey-wcPanel--reviews #reviews");t&&(e.classList.contains("--toggled")?rey.dom.isHidden(t)&&rey.animation.slideDown(t):rey.dom.isHidden(t)||(t.style.display="none"),e.addEventListener("click",(function(e){e.preventDefault(),e.currentTarget.classList.contains("--toggled")?(e.currentTarget.classList.remove("--toggled"),rey.animation.slideUp(t)):(e.currentTarget.classList.add("--toggled"),rey.animation.slideDown(t))})),e&&rey.dom.delegate(document,"click",'.woocommerce-review-link, a[href="#reviews"]',(function(r){var a=rey.dom.offset(e).top;a&&(r.preventDefault(),window.scrollTo({top:a-30,behavior:"smooth"})),rey.dom.isHidden(t)&&e.click()})))}},this.reviewsForm=function(){if(reyParams.ajax_add_review){var e=document.querySelector("#comments .commentlist");rey.dom.delegate(document,"submit","#respond form.comment-form",(function(t){t.preventDefault();var r=t.initiator,a=!1;t.submitter.classList.add("loading-spin");var o=r.querySelector(".woocommerce-error");if(o&&o.remove(),r.querySelectorAll("[required]").forEach((e=>{e.style.borderColor="",e.value||(e.style.borderColor="red",a=!0)})),a)t.submitter.classList.remove("loading-spin");else{var i=rey.util.getFormData(r);Object.keys(i).length?rey.ajax.request("submit_review",{formData:i,params:{cache:!1},cb:function(a){if(a&&a.success&&a.data){if(a.data.errors)return t.submitter.classList.remove("loading-spin"),void rey.dom.insertHtml(t.submitter,"beforebegin",a.data.errors);if(!e){var o="";return-1!==a.data.indexOf("woocommerce-review__awaiting-approval")&&(o+=reyParams.ajax_add_review_await_approval_text,o+=". "),o+=reyParams.ajax_add_review_reload_text,t.submitter.textContent=o,void setTimeout((function(){window.location.reload()}),3e3)}t.submitter.classList.remove("loading-spin"),rey.dom.insertHtml(e,"afterbegin",a.data),window.scrollTo({top:rey.dom.offset(e).top,behavior:"smooth"});var i=document.getElementById("review_form");i&&(i.style.display="none"),r.reset()}}}):console.error("Form data empty. Please reload and try again.")}}))}},this.addedToCartText=function(){e(document.body).on("added_to_cart",(function(t,r,a,o){if(void 0!==reyParams.added_to_cart_text){var i;if(o)if(o.hasClass("single_add_to_cart_button")&&!o.hasClass("elementor-button"))i=o,o=e(".single_add_to_cart_button-text",o);else if(o.hasClass("add_to_cart_button")){var n=e(".__text",o);n.length?o=n:o.children(".rey-icon").length&&(o=null)}if(o){var s=o.text();o.text(reyParams.added_to_cart_text);var d=parseInt(reyParams.added_to_cart_text_timeout||0);d&&setTimeout((function(){o.text(s),i&&i.removeClass("added")}),d)}}}))},this.fsSkinErrors=function(){if(!rey.vars.is_desktop){var t=e(".single-skin--fullscreen .woocommerce-notices-wrapper");t.length&&t.detach().prependTo(this.$productPage)}},this.general=function(){e('.rey-qtySelect ~ input[name^="quantity"]').remove()},this.ajaxLoadMoreReviews=function(){e(document).on("click",".rey-ajaxRatings-addBtn, .rey-reviewTop-add",(function(t){t.preventDefault();var r=e("#review_form_wrapper"),a=r.offset().top;r.children("#review_form").show("fast"),e("html, body").animate({scrollTop:a-rey.vars.adminBar-25},"fast",(function(e){return--e*e*e+1})),setTimeout((function(){e(document).trigger("reycore/woocommerce/reviews/loaded")}),100)}));var t=e(".rey-ajaxRatings-btn");if(t.length){var r=JSON.parse(t.attr("data-config")||"{}");if(r.qid&&r.total){var a,o=r.total,i=0,n=e("#reviews ol.commentlist"),s="newest",d=function(d,c){a&&a.abort(),a=rey.ajax.request("load_more_reviews",{data:{qid:r.qid,page:i,order:d||s},cb:function(r){t.removeClass("--disabled"),r.success&&r.data?(e("li.__loader",n).remove(),e(r.data).appendTo(n),t.removeClass("--loading"),i++,e(".__count",t).attr("data-current",i),i===o&&t.addClass("--disabled").removeClass("--loading"),c&&c.removeClass("--disabled"),e(document).trigger("reycore/woocommerce/reviews/loaded"),a=!1):t.addClass("--disabled").removeClass("--loading")}})};d(),t.on("click",(function(e){e.preventDefault(),t.addClass("--loading"),d()})),e(document).on("click",".rey-reviewSort li[data-key]",(function(){var r=e(this),a=r.parent(),o=r.attr("data-key");a.addClass("--disabled"),n.empty(),e('<li class="__loader"><div class="rey-lineLoader"></div></li>').appendTo(n),t.addClass("--disabled"),e(".__count",t).attr("data-current",1),r.siblings().removeClass("--active"),r.addClass("--active"),i=0,d(o,a),s=o}))}}},this.runLazyUpsells=function(){if(this.$productPage.length){var t=e(".__placeholder-wrapper.upsells.products");if(t.length){var r=rey.vars.page_id;r&&rey.frontend.inView({target:t,once:!0,cb:function(){rey.ajax.request("upsells_products",{ss:"upsells_products_"+r,data:{id:r},cb:function(e){if(e.data){t.replaceWith(e.data);var r=document.querySelector(".upsells.products");rey.hooks.doAction("product/loaded",r.querySelectorAll("li.product")),rey.hooks.doAction("woocommerce/carousel/loaded",r),rey.hooks.doAction("elementor/content/lazy_loaded",r)}}})}})}}},this.runLazyRelated=function(){if(this.$productPage.length){var t=e(".__placeholder-wrapper.related.products");if(t.length){var r=rey.vars.page_id;r&&rey.frontend.inView({target:t,once:!0,cb:function(){rey.ajax.request("related_products",{ss:"related_products_"+r,data:{id:r},cb:function(e){if(e.data){t.replaceWith(e.data);var r=document.querySelector(".related.products");rey.hooks.doAction("product/loaded",r.querySelectorAll("li.product")),rey.hooks.doAction("woocommerce/carousel/loaded",r),rey.hooks.doAction("elementor/content/lazy_loaded",r)}}})}})}}},this.runLazyReviews=function(){var t=this,r=e(".woocommerce-Reviews.--ajax");if(r.length){if(r.closest(".rey-summaryAcc").length)return e(document).one("click",".rey-summaryAcc-accItem.--reviews",(function(){t.ajaxLoadMoreReviews()})),void e(document).one("click",".reviews_acctab > a.--reviews",(function(){t.ajaxLoadMoreReviews()}));var a=r.closest(".woocommerce-Tabs-panel").length;if(a&&r.is(":visible"))return t.ajaxLoadMoreReviews();r.is(":visible")||a||!e(".rey-reviewsBtn").length?a?e(document).one("click",".reviews_tab > a",(function(){t.ajaxLoadMoreReviews()})):rey.hooks.addAction("first_interaction",(function(){setTimeout((function(){t.ajaxLoadMoreReviews()}),2e3)})):e(document).one("click",".rey-reviewsBtn",(function(){t.ajaxLoadMoreReviews()}))}},this.customTextNearPrice=function(){var t=e("span[data-price-text]",this.$productPage);t.length&&rey.ajax.request("pdp_custom_price_text",{data:{pid:t.attr("data-price-text")},params:{cache:!1},cb:function(e){e.data&&(rey.hooks.applyFilters("reycore/woocommerce/price_text/replace",!0,e,t)&&t.first().replaceWith(e.data),document.dispatchEvent(new CustomEvent("reycore/woocommerce/price_text_loaded",{detail:{response:e}})))}})},this.handleQtyInputMinStep=function(){rey.dom.delegate(document,"change","div.product input.qty",(function(e){var t=parseFloat(e.initiator.getAttribute("min")||0),r=parseFloat(e.initiator.getAttribute("step")||0),a=parseFloat(e.initiator.value);if(t&&t>a)e.initiator.value=t;else if(r&&a%r!=0){var o=Math.floor(a/r)*r;t&&(o=Math.max(t,o)),e.initiator.value=o}}))},this.init()};document.addEventListener("rey-DOMContentLoaded",(function(){new t}))}(jQuery);