!function(){"use strict";var t=function(){this.lastCount,this.isLoading=!1,this.isEnd=!1,this.isInfinite=!1,this.counter=!1,this.counterEl,this.init=function(){this.setButton(),this.theButton&&(this.counter=this.theButton.getAttribute("data-count"),this.getCounterText(),this.events())},this.setButton=function(t){var e=(t=t||document).querySelector(".js-rey-infiniteLoadMore");e?(this.isInfinite=!0,this.theButton=e,this.theButton.style.setProperty("--grid-height",this.theButton.parentElement.parentElement.offsetHeight+"px")):this.theButton=t.querySelector(".js-rey-ajaxLoadMore")},this.events=function(){this.isInfinite?rey.frontend.inView({target:this.theButton,cb:t=>{t.target.classList.contains("--disabled")||this.isLoading||this.isEnd||this.getPosts()}}):this.theButton.addEventListener("click",(t=>{t.preventDefault(),t.currentTarget.classList.contains("--disabled")||this.isLoading||this.isEnd||this.getPosts()}))},this.getPosts=function(){this.href=this.theButton.getAttribute("href"),this.target=this.theButton.getAttribute("data-target"),this.container=document.querySelector(this.target),this.selectors=this.theButton.getAttribute("data-items"),this.history=this.theButton.getAttribute("data-history")||"1",this.ptype=this.theButton.getAttribute("data-post-type")||"posts",this.setUrl(),this.ajaxCall()},this.setUrl=function(){var t="";document.querySelector("div.rey-postList")||document.querySelector("body.elementor-page")||document.querySelector(".elementor.elementor-location-archive")||(t=(-1!==window.location.href.indexOf("?")?"&":"?")+"reynotemplate=1"),this.url=this.href+t},this.ajaxCallback=function(t){var e,s={target:this.target,grid:!1,items:!1,container:this.container,data:t};this.container&&(s.data=document.createElement("div"),s.data.innerHTML=t,e=s.data.querySelector(".rey-ajaxLoadMore a"),s.grid=s.data.querySelector(this.target),s.grid&&(s.items=s.grid.querySelectorAll(this.selectors),s.items.length&&s.items.forEach((t=>{s.container.append(t)})),this.handleAssets(s.data))),e?(this.theButton.setAttribute("href",e.getAttribute("href")),this.events()):(this.isEnd=!0,this.theButton.classList.add("--disabled","--end")),this.getCounterText(e),this.isLoading=!1,this.theButton.classList.remove("--loading"),"1"===this.history&&window.history.pushState(null,"",this.href),rey.hooks.doAction("post/loaded",s.items),"post"!==this.ptype&&rey.hooks.doAction(this.ptype+"/loaded",s.items)},this.ajaxCall=function(){this.theButton.classList.add("--loading"),this.isLoading=!0;var t=new XMLHttpRequest;t.open("GET",this.url,!0),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.onload=()=>{t.status>=200&&t.status<400&&this.ajaxCallback(t.responseText)},t.send()},this.handleAssets=function(t){var e=t.querySelector("div[data-loop-assets]");if(e){var s=JSON.parse(e.getAttribute("data-loop-assets")||"{}");s.styles&&s.scripts&&(rey.assets.lazyAssets(s),Object.keys(reyParams.lazy_assets).forEach((t=>{document.querySelectorAll(t).length&&rey.assets.lazyAssets(reyParams.lazy_assets[t])})))}},this.getCounterText=function(t){if(this.counter)if(this.isEnd)this.counterEl&&this.counterEl.remove();else{if(t)return this.counter=t.getAttribute("data-count"),this.lastCount&&(this.counter=this.lastCount),t.getAttribute("data-end-count")&&(this.lastCount=t.getAttribute("data-end-count")),void(this.counterEl&&(this.counterEl.textContent=this.counter));this.counterEl=document.createElement("span"),this.counterEl.classList.add("rey-ajaxLoadMore-counter"),this.counterEl.textContent=this.counter,this.theButton.append(this.counterEl)}},this.init()};rey.hooks.addAction("ajaxfilters/finished",(function(e){new t})),rey.hooks.addAction("first_interaction",(function(){new t}))}();