!function(){"use strict";new function(){this.modals={},this.init=function(){this.wrapper=document.querySelector('.rey-itemManager-wrapper[data-type="plugins"]'),this.wrapper&&(this.refreshBtn=document.querySelector(".__manager-refresh"),this.events())},this.events=function(){this.wrapper.querySelectorAll(".rey-adminBtn[data-action]").forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();var a={};a.action=e.getAttribute("data-action"),a.slug=e.getAttribute("data-slug"),a.action&&a.slug&&(this.wrapper.classList.add("--lock"),e.classList.add("--loading"),rey.ajax.request("run_plugin_action",{data:a,cb:t=>{if(t&&t.success){if(t.data.error)return e.classList.add("--disabled"),void console.log(t.data.error);if(this.wrapper.classList.remove("--lock"),e.textContent=t.data.text,e.setAttribute("data-action",t.data.new_action),e.classList.remove("--loading"),t.data.version){var a=e.closest(".rey-itemManager-item");if(a){var r=a.querySelector(".__version");r&&(r.textContent=t.data.version)}}}else e.classList.add("--disabled")}}))}))})),window.addEventListener("beforeunload",(e=>{if(window.isImporting)return e.preventDefault(),e.returnValue="","Is importing"}),!0),this.refreshBtn&&this.refreshBtn.addEventListener("click",(e=>{e.preventDefault(),this.refreshBtn.classList.add("--loading"),rey.ajax.request("run_plugins_refresh",{cb:e=>{this.refreshBtn.textContent=reyPluginManagerParams.text.reloading,setTimeout((()=>{location.reload()}),1e3)}})}))},this.init()}}();