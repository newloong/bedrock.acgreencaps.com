!function(e){"use strict";var t={running:!1,pid:!1,$grid:!1,needsPanelMarkup:!1,hasContent:!1,_panel:"#js-rey-quickviewPanel",isOpen:!1,maybeCloseOverlay:!0,openStyle:"curtain",initialDuration:400,timelineDuration:0,canClose:!0,init:function(){this.running||(this.setQvData(!0),this.setupPanel(),this.events(),this.running=!0)},setupPanel:function(){this.panel=document.getElementById("js-rey-quickviewPanel"),this.$panel=e(this.panel),this.panel?(this.needsPanelMarkup=!1,this.$panelContainer=e(".rey-quickview-container",this.$panel),this.panelContainer=this.panel.querySelector(".rey-quickview-container"),this.timelineDuration=this.initialDuration,this.panelContainer&&(this.openStyle=this.panelContainer.getAttribute("data-openstyle"),rey.vars.is_desktop||!reyParams.quickview_only&&!reyParams.quickview_mobile||(this.openStyle="slide",this.panelContainer.setAttribute("data-openstyle",this.openStyle)))):this.needsPanelMarkup=!0},events:function(){var i=function(i){if(i.preventDefault(),rey.vars.is_desktop||reyParams.quickview_mobile){var n=e(this);t.pid=n.attr("data-id")||n.closest("li.product").attr("data-pid"),t.pid&&(rey.frontend.overlay.open("site"),rey.frontend.overlay.keepOpen=!0,t.$grid=n.closest("ul.products"),t.open())}};e(document).on("click",".js-rey-quickviewBtn",i),reyParams.quickview_only&&(e(document).on("click","li.product .woocommerce-loop-product__link",i),e(document).on("click","li.product .woocommerce-loop-product__title a",i),e(document).on("click","li.product .rey-productSlideshow a",i)),e(document).on("click",".rey-qvNav button",(function(i){i.preventDefault();var n=e(this).attr("data-id");n&&(t.maybeCloseOverlay=!1,t.timelineDuration=0,t.pid=n,t.open(!0))})),e(document).on("click",".js-rey-quickviewPanel-close",(function(e){e.preventDefault(),t.maybeCloseOverlay=!0,t.close()})),e(document).on("keydown",(function(e){t.isOpen&&t.canClose&&27==e.keyCode&&(t.maybeCloseOverlay=!0,t.close())})),e(document.body).on("added_to_cart",(function(e,i,n,a){t.isOpen&&(t.maybeCloseOverlay=!1,""===reyParams.after_add_to_cart&&(t.maybeCloseOverlay=!0),t.close())}))},setQvData:function(t){if(t&&(this.quickviewData={prev:"",next:""}),this.$grid){var i=e('li.product[data-pid="'+this.pid+'"]',this.$grid),n="",a="",r=i.prev('li.product:not([data-pid^="x"])');r.length&&(n=r.attr("data-pid"));var o=i.next('li.product:not([data-pid^="x"])');o.length&&(a=o.attr("data-pid")),this.quickviewData.prev=n,this.quickviewData.next=a}},open:function(t){if(this.$panel.length&&this.$panel[0].hasAttribute("data-lazy-hidden")&&this.$panel[0].removeAttribute("data-lazy-hidden"),!this.pid)return this.close();t||rey.frontend.panels.init(this.close.bind(this)),this.setQvData(),rey.elements.body.classList.add("quickview--is-opened"),this.$panel.addClass("--is-loading"),reyParams.quickview_mobile&&!rey.vars.is_desktop&&(rey.elements.body.style.overflow="hidden"),this.isOpen=!0,rey.jquery.trigger("reycore/before_quickview",document,[this.pid]),rey.ajax.request("get_quickview_product",{data:{id:this.pid,markup:this.needsPanelMarkup,woo_template:document.getElementById("tmpl-variation-template")?1:0,pswp:document.querySelector(".pswp")?1:0},cb:t=>{t.data&&(this.needsPanelMarkup&&t.data.markup&&(e(t.data.markup).appendTo(document.body),this.setupPanel()),!e("#tmpl-variation-template").length&&t.data["woo-template-scripts"]&&e(t.data["woo-template-scripts"]).appendTo(document.body),!document.querySelector(".pswp")&&t.data.pswp&&e(t.data.pswp).appendTo(document.body),this.panelContainer.innerHTML=t.data.content,this.after_qv(this.panelContainer),rey.hooks.doAction("after_quickview",this.panelContainer,this),rey.jquery.trigger("reycore/after_quickview",document,[this.panelContainer]))}})},after_qv:function(i){var n=e(i);if(this.panel.classList.add("--is-visible"),this.panel.classList.remove("--is-loading"),void 0!==rey.components.pdpGallery){var a=i.querySelector(".woocommerce-product-gallery");a&&new rey.components.pdpGallery(a,{directRun:!0,id:"quickview-gallery",onLightboxOpen:e=>{t.canClose=!1,rey.frontend.panels.keepOpen=!0},onLightboxDestroy:e=>{t.canClose=!0,rey.frontend.panels.keepOpen=null},variationForm:i.querySelector(`form.variations_form[data-product_id="${t.pid||0}"]`)})}e('.rey-qtySelect ~ input[name^="quantity"]').remove(),rey.hooks.doAction("refresh_general_html",n),e(".woocommerce-review-link",n).attr("href",e("h1.product_title a",n).attr("href")+"#reviews");var r=i.querySelector(".quantity .qty");r&&r.dispatchEvent(new Event("change"));var o={easing:"easeInOutQuart",duration:this.timelineDuration,complete:()=>{this.after_qv_effect(i),rey.jquery.trigger("reycore/after_quickview_effect",document,[n]),rey.hooks.doAction("after_quickview_effect",n[0]),this.timelineDuration=this.initialDuration}};if("curtain"===this.openStyle)anime.timeline(o).add({targets:t._panel+" .rey-quickview-container",scaleX:[0,1]}).add({targets:t._panel+" .rey-quickview-mask",scaleX:[1,0],delay:function(e,t){return 250*t}}).add({targets:t._panel+" .rey-productSummary",scale:[1.1,1]},"-=400");else if("slide"===this.openStyle){o.duration="600",o.easing="easeOutQuart",anime.timeline(o).add({targets:t._panel+" .rey-quickview-container",translateY:[150,0],scale:[.95,1],opacity:[0,1]})}},after_qv_effect:function(i){var n=e(i),a=t.$panel.find(".js-scrollbar");a.length&&"undefined"!=typeof SimpleScrollbar&&rey.vars.is_desktop&&SimpleScrollbar.initEl(a[0]),void 0!==e.fn.wc_variation_form&&e(".variations_form",n).each((function(){e(this).wc_variation_form()})),e(".rey-qvNav-prev",n).attr("data-id",t.quickviewData.prev||""),e(".rey-qvNav-next",n).attr("data-id",t.quickviewData.next||"")},close:function(){rey.frontend.panels.reset(),rey.frontend.overlay.keepOpen=null,this.maybeCloseOverlay&&rey.frontend.overlay.close(),rey.elements.body.classList.remove("quickview--is-opened"),reyParams.quickview_mobile&&!rey.vars.is_desktop&&(rey.elements.body.style.overflow=""),this.$panel&&this.$panel.length&&(this.$panel.removeClass("--is-visible --is-loading"),this.cleanupPanel()),this.isOpen=!1,this.maybeCloseOverlay=!0},cleanupPanel:function(){this.$panelContainer.fadeOut("fast",(function(){e(this).attr("style","").children().remove()}))}};document.addEventListener("rey-DOMContentLoaded",(function(e){t.init()})),rey.hooks.addAction("elementor/element/lazy_loaded",(function(){t.init()})),rey.hooks.addAction("elementor/content/lazy_loaded",(function(){t.init()})),rey.hooks.addAction("minicart/assets_ready",(function(){t.init()})),rey.hooks.addAction("wishlist/loaded",(function(){t.init()}))}(jQuery);